<!DOCTYPE html>
<html lang="en">
	<head>
		<title><!-- title --></title>
		<meta charset="utf-8">
		<meta name="generator" content="Three.js Editor">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				font-family: sans-serif;
				font-size: 11px;
				background-color: #000;
				margin: 0px;
			}
			canvas {
				display: block;
			}
		</style>
	</head>
	<body ontouchstart="">
		<script type="importmap">
			{
				"imports": {
					"three": "./js/three.module.min.js",
					"@engine/": "./js/"
				}
			}
		</script>
		<script type="module">

			import * as THREE from 'three';
			import { pc, App, SceneLoader, Script, registerComponent, attribute } from './js/three-engine.js';

			window.THREE = THREE;

			if ( !window.__engineExports ) {
				window.__engineExports = {};
			}

			window.__engineExports.Script = Script;
			window.__engineExports.registerComponent = registerComponent;
			window.__engineExports.attribute = attribute;

			var loader = new THREE.FileLoader();
			loader.load( 'app.json', function ( text ) {

				const json = JSON.parse( text );
				const canvas = document.createElement( 'canvas' );
				canvas.style.cssText = 'width: 100%; height: 100%; display: block;';
				document.body.appendChild( canvas );

				pc.init( canvas, {
					antialias: true,
					alpha: false,
					powerPreference: 'high-performance'
				} );

				const app = pc.createApp();
				SceneLoader.loadScene( app, json );

				const scene = app.scene;
				const camera = app.camera;
				const renderer = pc.renderer;

				function onWindowResize() {
					const width = window.innerWidth;
					const height = window.innerHeight;
					renderer.setSize( width, height );
					app.onResize( width, height );
				}

				onWindowResize();
				window.addEventListener( 'resize', onWindowResize );

				pc.start();

			} );

			/* edit button */

		</script>
	</body>
</html>
